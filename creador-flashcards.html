<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creador de Flashcards - Periplo v23.0 (Optimizado)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap'); 
        body { font-family: 'Nunito', sans-serif; }
        .btn-icon { @apply p-2 rounded-lg transition-colors duration-200; }
        /* Animaciones */
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .modal-box { animation: fadeIn 0.2s ease-out; }
        .card-enter { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { createRoot } = ReactDOM;

        const DashboardCreador = () => {
            const generateUniqueId = () => Date.now().toString(36) + Math.random().toString(36).substr(2);

            // --- ESTADOS ---
            const [title, setTitle] = useState(localStorage.getItem('tempNewActivityName') || '');
            const [cards, setCards] = useState([{ internalId: generateUniqueId(), front: '', back: '', image: null }]);
            const [aiPrompt, setAiPrompt] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [statusText, setStatusText] = useState('');
            const [toasts, setToasts] = useState([]);
            const [manualLinkMode, setManualLinkMode] = useState(null);
            
            // CACH√â DEL MODELO (Para no preguntar a Google cada vez)
            const [cachedModel, setCachedModel] = useState(null);

            // EDITOR DE IMAGEN
            const [imageEditor, setImageEditor] = useState({ isOpen: false, cardId: null, prompt: '', currentImage: null, loading: false });

            // CONFIGURACI√ìN
            const [langConfig, setLangConfig] = useState({ left: 'en-US', right: 'es-MX' }); 
            const [audioEnabled, setAudioEnabled] = useState({ left: true, right: false });
            const [showConfig, setShowConfig] = useState(false);
            const [apiKeys, setApiKeys] = useState({ google: '' });

            useEffect(() => { 
                const savedGoogle = localStorage.getItem('periplo_google_key');
                if (savedGoogle) setApiKeys({ google: savedGoogle });
                else setShowConfig(true);
            }, []);

            const saveApiKeys = () => {
                if (!apiKeys.google) return addToast("La clave es obligatoria", 'error');
                localStorage.setItem('periplo_google_key', apiKeys.google);
                setShowConfig(false);
                addToast("Clave guardada", 'success');
            };

            // --- HELPERS ---
            const addToast = (message, type = 'error') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
                setTimeout(() => removeToast(id), 5000);
            };
            const removeToast = (id) => setToasts(prev => prev.filter(t => t.id !== id));
            const cleanJsonText = (text) => text.replace(/```json/g, '').replace(/```/g, '').trim();

            const playAudio = (text, lang) => {
                if (!text) return;
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text);
                u.lang = lang; u.rate = 0.9;
                window.speechSynthesis.speak(u);
            };

            // --- 1. IA TEXTO (Google Gemini - OPTIMIZADO) ---
            const findBestModel = async (key) => {
                // Si ya sabemos el modelo, no gastamos una petici√≥n
                if (cachedModel) return cachedModel;

                setStatusText("üîç Detectando...");
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${key}`);
                    if (!response.ok) throw new Error("Error al consultar modelos");
                    const data = await response.json();
                    const availableModels = (data.models || [])
                        .filter(m => m.supportedGenerationMethods.includes("generateContent"))
                        .map(m => m.name.replace("models/", ""));

                    // Prioridad: 2.5 > flash > cualquiera
                    let chosen = availableModels.find(m => m.includes("2.5")) || 
                                 availableModels.find(m => m.includes("flash")) || 
                                 availableModels[0];
                    
                    if (!chosen) throw new Error("Sin modelos disponibles.");
                    
                    setCachedModel(chosen); // ¬°GUARDARLO EN MEMORIA!
                    return chosen;
                } catch (e) {
                    console.error("Fallo detecci√≥n:", e);
                    return "gemini-1.5-flash"; 
                }
            };

            const generateList = async () => {
                if (!apiKeys.google) { setShowConfig(true); return; }
                if (!aiPrompt.trim()) return;
                if (isGenerating) return; // Evitar doble clic
                
                setIsGenerating(true);
                try {
                    let key = apiKeys.google.trim();
                    if (key.indexOf("AIzaSyAIzaSy") !== -1) key = key.replace("AIzaSyAIzaSy", "AIzaSy");

                    const modelName = await findBestModel(key);
                    setStatusText(`üöÄ Creando con ${modelName}...`);

                    const finalPrompt = `
                        Eres un experto educativo.
                        Analiza: "${aiPrompt}".
                        
                        TAREA:
                        1. Si es un TEMA (ej: "aeropuerto"): Crea una lista de 30 palabras √∫tiles.
                        2. Si es una LISTA pegada: Traduce y ordena todos los elementos.
                        
                        SALIDA: Solo JSON Array [{"front": "Ingl√©s", "back": "Espa√±ol"}]
                    `;

                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${key}`,
                        {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ contents: [{ parts: [{ text: finalPrompt }] }] })
                        }
                    );

                    if (!response.ok) {
                        if (response.status === 429) throw new Error("üö¶ Demasiado r√°pido. Espera 1 minuto y reintenta.");
                        throw new Error(`Error API (${response.status})`);
                    }

                    const data = await response.json();
                    const rawText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                    const newItems = JSON.parse(cleanJsonText(rawText));
                    
                    if (Array.isArray(newItems)) {
                        const formatted = newItems.map(item => ({ internalId: generateUniqueId(), front: item.front || '', back: item.back || '', image: null }));
                        setCards(prev => [...prev, ...formatted]);
                        setAiPrompt('');
                        addToast(`¬°+${formatted.length} tarjetas a√±adidas!`, 'success');
                    }
                } catch (e) {
                    addToast(e.message, 'error');
                } finally {
                    setIsGenerating(false);
                    setStatusText('');
                }
            };

            // --- 2. EDITOR DE IM√ÅGENES (POLLINATIONS) ---
            const buildPollinationsUrl = (prompt) => {
                const seed = Math.floor(Math.random() * 99999);
                const finalPrompt = encodeURIComponent(`${prompt}, simple vector art, minimalist, white background, high quality`);
                return `https://image.pollinations.ai/prompt/${finalPrompt}?width=400&height=400&seed=${seed}&nologo=true`;
            };

            const openImageEditor = (card) => {
                setImageEditor({
                    isOpen: true,
                    cardId: card.internalId,
                    prompt: card.front, 
                    currentImage: card.image,
                    loading: !card.image 
                });
                
                if (!card.image) {
                    const url = buildPollinationsUrl(card.front);
                    setImageEditor(prev => ({ ...prev, currentImage: url, loading: false }));
                }
            };

            const handleRegeneratePreview = () => {
                if (!imageEditor.prompt) return;
                setImageEditor(prev => ({ ...prev, loading: true }));
                setTimeout(() => {
                    const url = buildPollinationsUrl(imageEditor.prompt);
                    setImageEditor(prev => ({ ...prev, currentImage: url, loading: false }));
                }, 300);
            };

            const saveImageFromEditor = () => {
                setCards(prev => prev.map(c => c.internalId === imageEditor.cardId ? { ...c, image: imageEditor.currentImage } : c));
                setImageEditor({ ...imageEditor, isOpen: false });
                addToast("Imagen actualizada", "success");
            };

            const autoFillAIImages = async () => {
                const pending = cards.filter(c => c.front && !c.image);
                if (pending.length === 0) return addToast("Nada que rellenar", 'info');
                
                addToast("üé® Pintando im√°genes...", "info");
                for (let i = 0; i < pending.length; i++) {
                    const card = pending[i];
                    const url = buildPollinationsUrl(card.front);
                    setCards(prev => prev.map(c => c.internalId === card.internalId ? { ...c, image: url } : c));
                    await new Promise(r => setTimeout(r, 600)); // Pausa para no saturar
                }
                addToast("¬°Terminado!", 'success');
            };

            // --- UI HELPERS ---
            const handleMoveCard = (index, direction) => {
                if ((direction === -1 && index === 0) || (direction === 1 && index === cards.length - 1)) return;
                const newCards = [...cards];
                [newCards[index], newCards[index + direction]] = [newCards[index + direction], newCards[index]];
                setCards(newCards);
            };

            const handleClearAll = () => {
                if (confirm("¬øBorrar todo?")) setCards([{ internalId: generateUniqueId(), front: '', back: '', image: null }]);
            };

            const handleManualLink = (id, url) => {
                if(url) setCards(prev => prev.map(c => c.internalId === id ? { ...c, image: url } : c));
                setManualLinkMode(null);
            };

            const handleSave = () => {
                if (!title.trim()) return addToast("Ponle t√≠tulo", 'warning');
                console.log({ title, cards });
                addToast("¬°Guardado!", 'success');
                if(confirm("Guardado. ¬øSalir?")) window.location.href = "/";
            };

            const swapColumns = () => {
                if(confirm("¬øIntercambiar idiomas?")) {
                    setCards(prev => prev.map(c => ({ ...c, front: c.back, back: c.front })));
                    setLangConfig(prev => ({ left: prev.right, right: prev.left }));
                    setAudioEnabled(prev => ({ left: prev.right, right: prev.left }));
                }
            };

            return (
                <div className="min-h-screen bg-slate-100 py-8 px-4 font-sans text-slate-900 pb-32">
                    
                    {/* MODAL CONFIG */}
                    {showConfig && (
                        <div className="fixed inset-0 z-[70] bg-black/80 flex items-center justify-center p-4 backdrop-blur-sm">
                            <div className="bg-white w-full max-w-md rounded-2xl p-6 shadow-2xl modal-box relative">
                                {!apiKeys.google ? null : (
                                    <button onClick={() => setShowConfig(false)} className="absolute top-4 right-4 text-slate-400 hover:text-slate-600"><i className="fa-solid fa-times"></i></button>
                                )}
                                <h2 className="text-xl font-black mb-3 flex items-center gap-2">
                                    <i className="fa-solid fa-key text-yellow-500"></i> Configuraci√≥n API
                                </h2>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-xs font-bold text-slate-700 uppercase mb-1">Google Gemini API Key</label>
                                        <input value={apiKeys.google} onChange={e => setApiKeys({...apiKeys, google: e.target.value})} type="password" placeholder="AIzaSy..." className="w-full border-2 border-slate-200 rounded-xl px-3 py-2 font-mono text-sm focus:border-indigo-500 outline-none"/>
                                    </div>
                                    <button onClick={saveApiKeys} className="w-full bg-slate-900 text-white py-3 rounded-xl font-bold hover:bg-black transition-all">Guardar</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* MODAL EDITOR IMAGEN */}
                    {imageEditor.isOpen && (
                        <div className="fixed inset-0 z-[60] bg-black/90 flex items-center justify-center p-4 backdrop-blur-md">
                            <div className="bg-white w-full max-w-lg rounded-2xl overflow-hidden shadow-2xl modal-box flex flex-col max-h-[90vh]">
                                <div className="p-4 border-b flex justify-between items-center bg-slate-50">
                                    <h3 className="font-bold text-lg"><i className="fa-solid fa-palette text-pink-500"></i> Dise√±ador de Imagen</h3>
                                    <button onClick={() => setImageEditor({ ...imageEditor, isOpen: false })} className="p-2 hover:bg-slate-200 rounded-full"><i className="fa-solid fa-times"></i></button>
                                </div>
                                <div className="aspect-square bg-slate-100 flex items-center justify-center relative overflow-hidden group">
                                    {imageEditor.loading ? (
                                        <div className="text-center">
                                            <i className="fa-solid fa-spinner fa-spin fa-3x text-indigo-500 mb-2"></i>
                                            <p className="font-bold text-slate-400">Pintando...</p>
                                        </div>
                                    ) : (
                                        <img src={imageEditor.currentImage} className="w-full h-full object-contain" onError={(e) => { e.target.src=''; addToast("Error imagen", 'error'); }} />
                                    )}
                                </div>
                                <div className="p-5 space-y-4 bg-white">
                                    <div>
                                        <label className="block text-xs font-bold text-slate-500 uppercase mb-1">Contexto:</label>
                                        <div className="flex gap-2">
                                            <input value={imageEditor.prompt} onChange={e => setImageEditor({...imageEditor, prompt: e.target.value})} onKeyDown={e => e.key === 'Enter' && handleRegeneratePreview()} placeholder="Ej: Manzana roja" className="flex-1 border-2 border-slate-200 rounded-xl px-3 py-2 font-bold text-sm focus:border-indigo-500 outline-none"/>
                                            <button onClick={handleRegeneratePreview} className="bg-indigo-100 text-indigo-600 px-4 rounded-xl hover:bg-indigo-200 font-bold"><i className="fa-solid fa-rotate"></i></button>
                                        </div>
                                    </div>
                                    <button onClick={saveImageFromEditor} className="w-full bg-slate-900 text-white py-3 rounded-xl font-bold hover:bg-black transition-all shadow-lg"><i className="fa-solid fa-check"></i> Usar esta Imagen</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* TOASTS */}
                    <div className="fixed bottom-4 right-4 z-50 flex flex-col gap-2 pointer-events-none">
                        {toasts.map(t => (
                            <div key={t.id} className={`px-4 py-3 rounded-xl shadow-xl text-sm font-bold pointer-events-auto border-2 ${t.type==='error'?'bg-red-50 border-red-100 text-red-600': (t.type === 'info' ? 'bg-blue-50 border-blue-100 text-blue-600' : 'bg-green-50 border-green-100 text-green-700')} animate-in slide-in-from-right`}>{t.message}</div>
                        ))}
                    </div>

                    <div className="max-w-6xl mx-auto space-y-6">
                        {/* HEADER */}
                        <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4 sticky top-2 z-30">
                            <div className="flex items-center gap-3 w-full md:w-auto">
                                <button onClick={() => window.location.href='/'} className="p-2 hover:bg-slate-100 rounded-lg text-slate-500"><i className="fa-solid fa-arrow-left"></i></button>
                                <input value={title} onChange={e => setTitle(e.target.value)} placeholder="T√≠tulo de la Actividad..." className="text-lg font-black bg-transparent outline-none w-full md:w-64"/>
                            </div>
                            
                            <div className="flex gap-2 items-center">
                                <button onClick={handleClearAll} className="px-3 py-2 bg-red-50 hover:bg-red-100 text-red-500 rounded-lg font-bold text-xs flex items-center gap-1 transition-colors" title="Borrar Todo"><i className="fa-solid fa-trash-can"></i></button>
                                <button onClick={() => setShowConfig(true)} className="px-3 py-2 bg-slate-100 hover:bg-slate-200 text-slate-500 rounded-lg font-bold text-xs" title="Configurar"><i className="fa-solid fa-gear"></i></button>
                                
                                <div className="flex items-center bg-slate-100 rounded-lg p-1 border border-slate-200">
                                    <button onClick={() => setAudioEnabled({...audioEnabled, left: !audioEnabled.left})} className={`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${audioEnabled.left ? 'bg-indigo-600 text-white shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}>{audioEnabled.left ? <i className="fa-solid fa-volume-high"></i> : <i className="fa-solid fa-volume-xmark"></i>} EN</button>
                                    <button onClick={() => setAudioEnabled({...audioEnabled, right: !audioEnabled.right})} className={`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${audioEnabled.right ? 'bg-pink-600 text-white shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}>{audioEnabled.right ? <i className="fa-solid fa-volume-high"></i> : <i className="fa-solid fa-volume-xmark"></i>} ES</button>
                                </div>
                                <button onClick={handleSave} className="bg-slate-900 text-white px-5 py-2 rounded-xl font-bold hover:bg-black shadow-lg hover:shadow-xl transition-all flex items-center gap-2"><i className="fa-solid fa-save"></i> Guardar</button>
                            </div>
                        </div>

                        {/* IA BARRA */}
                        <div className="bg-indigo-600 rounded-2xl p-1 shadow-lg">
                            <div className="bg-white/10 backdrop-blur-md rounded-xl p-3 flex flex-col md:flex-row gap-2 items-center">
                                <i className="fa-solid fa-wand-magic-sparkles text-white text-xl mx-2"></i>
                                <div className="flex-1 w-full">
                                    <input value={aiPrompt} onChange={e => setAiPrompt(e.target.value)} placeholder="Ej: 'Aeropuerto' (Tema) o pega tu lista..." className="w-full bg-transparent border-none text-white font-bold outline-none placeholder:text-indigo-200 text-lg" onKeyDown={e => {
                                        if (e.key === 'Enter') {
                                            e.preventDefault(); // EVITA DOBLE ENTER
                                            generateList();
                                        }
                                    }}/>
                                    {statusText && <div className="text-indigo-200 text-xs font-mono mt-1">{statusText}</div>}
                                </div>
                                <button onClick={generateList} disabled={isGenerating || !aiPrompt} className="bg-white text-indigo-700 px-6 py-3 rounded-xl font-bold hover:bg-indigo-50 disabled:opacity-50 text-sm flex items-center gap-2 shadow-lg transition-all active:scale-95 whitespace-nowrap">
                                    {isGenerating ? <span><i className="fa-solid fa-spinner fa-spin"></i> Trabajando...</span> : <span><i className="fa-solid fa-bolt"></i> Generar</span>}
                                </button>
                            </div>
                        </div>

                        {/* BOT√ìN RELLENAR IM√ÅGENES */}
                        <div className="flex justify-end">
                             <button onClick={autoFillAIImages} disabled={cards.length <= 1} className="bg-white border-2 border-pink-100 text-pink-600 px-6 py-3 rounded-xl font-bold hover:bg-pink-50 hover:border-pink-200 shadow-sm transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                                <i className="fa-solid fa-palette"></i> Pintar Todo (Auto)
                            </button>
                        </div>

                        {/* TABLA */}
                        <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                            <div className="grid grid-cols-12 gap-4 p-4 bg-slate-50 border-b text-xs font-black text-slate-400 uppercase items-center">
                                <div className="col-span-1 text-center">#</div>
                                <div className="col-span-4 pl-2">{langConfig.left === 'en-US' ? 'Ingl√©s' : 'Espa√±ol'}</div>
                                <div className="col-span-1 text-center"><button onClick={swapColumns} className="hover:bg-slate-100 p-1 rounded text-slate-500 transition-colors" title="Intercambiar Todo"><i className="fa-solid fa-right-left"></i></button></div>
                                <div className="col-span-4 pl-2">{langConfig.right === 'es-MX' ? 'Espa√±ol' : 'Ingl√©s'}</div>
                                <div className="col-span-2 text-right pr-2">Acciones</div>
                            </div>

                            <div className="divide-y divide-slate-100">
                                {cards.map((card, index) => (
                                    <div key={card.internalId} className="grid grid-cols-1 sm:grid-cols-12 gap-4 p-4 hover:bg-slate-50 items-start group card-enter">
                                        <div className="sm:col-span-1 flex flex-col items-center justify-center gap-1 pt-2">
                                            <button onClick={() => handleMoveCard(index, -1)} disabled={index === 0} className="text-slate-300 hover:text-indigo-600 disabled:opacity-0 transition-colors"><i className="fa-solid fa-chevron-up"></i></button>
                                            <div className="font-black text-slate-300 text-xs">{index + 1}</div>
                                            <button onClick={() => handleMoveCard(index, 1)} disabled={index === cards.length - 1} className="text-slate-300 hover:text-indigo-600 disabled:opacity-0 transition-colors"><i className="fa-solid fa-chevron-down"></i></button>
                                        </div>
                                        
                                        <div className="sm:col-span-4 flex gap-2">
                                            <input value={card.front} onChange={e => setCards(prev => prev.map(c => c.internalId === card.internalId ? {...c, front: e.target.value} : c))} className="w-full border-2 border-slate-200 rounded-xl px-3 py-2 font-bold focus:border-indigo-500 outline-none text-slate-700 placeholder:text-slate-300" placeholder="..."/>
                                            {audioEnabled.left && <button onClick={() => playAudio(card.front, langConfig.left)} className="text-indigo-500 btn-icon hover:bg-indigo-50"><i className="fa-solid fa-volume-high"></i></button>}
                                        </div>

                                        <div className="sm:col-span-1 flex justify-center pt-1">
                                            {card.image ? (
                                                <div className="relative w-14 h-14 rounded-lg overflow-hidden group/img shadow-sm border border-slate-200 bg-white">
                                                    <img src={card.image} className="w-full h-full object-cover cursor-pointer hover:scale-110 transition-transform" onClick={() => openImageEditor(card)}/>
                                                    <button onClick={() => setCards(prev => prev.map(c => c.internalId === card.internalId ? {...c, image: null} : c))} className="absolute top-0 right-0 bg-red-500 text-white w-5 h-5 flex items-center justify-center text-xs shadow-md z-10"><i className="fa-solid fa-times"></i></button>
                                                </div>
                                            ) : manualLinkMode === card.internalId ? (
                                                <input autoFocus placeholder="URL..." className="w-16 text-xs border rounded p-1" onBlur={(e) => handleManualLink(card.internalId, e.target.value)} onKeyDown={(e) => e.key==='Enter' && handleManualLink(card.internalId, e.currentTarget.value)}/>
                                            ) : (
                                                <button onClick={() => openImageEditor(card)} className="w-14 h-14 rounded-lg border-2 border-dashed border-slate-300 text-slate-300 hover:border-pink-500 hover:text-pink-500 hover:bg-pink-50 transition-all flex flex-col items-center justify-center" title="Dise√±ar Imagen">
                                                    <i className="fa-solid fa-paintbrush"></i>
                                                </button>
                                            )}
                                        </div>

                                        <div className="sm:col-span-4 flex gap-2">
                                            <input value={card.back} onChange={e => setCards(prev => prev.map(c => c.internalId === card.internalId ? {...c, back: e.target.value} : c))} className="w-full border-2 border-slate-200 rounded-xl px-3 py-2 font-bold focus:border-pink-500 outline-none text-slate-700 placeholder:text-slate-300" placeholder="..."/>
                                            {audioEnabled.right && <button onClick={() => playAudio(card.back, langConfig.right)} className="text-pink-500 btn-icon hover:bg-pink-50"><i className="fa-solid fa-volume-high"></i></button>}
                                        </div>

                                        <div className="sm:col-span-2 flex justify-end gap-2 pt-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                            <button onClick={() => setManualLinkMode(card.internalId)} className="text-slate-400 hover:text-blue-600 btn-icon hover:bg-blue-50" title="Pegar Link"><i className="fa-solid fa-link"></i></button>
                                            <button onClick={() => window.open(`https://www.google.com/search?tbm=isch&q=${card.front || card.back}`, '_blank')} className="text-slate-400 hover:text-green-600 btn-icon hover:bg-green-50" title="Google"><i className="fa-solid fa-external-link-alt"></i></button>
                                            <button onClick={() => {
                                                const newCards = [...cards];
                                                newCards.splice(index + 1, 0, { ...card, internalId: generateUniqueId() });
                                                setCards(newCards);
                                            }} className="text-slate-400 hover:text-indigo-600 btn-icon hover:bg-indigo-50" title="Duplicar"><i className="fa-solid fa-copy"></i></button>
                                            <button onClick={() => cards.length > 1 && setCards(prev => prev.filter(c => c.internalId !== card.internalId))} className="text-slate-400 hover:text-red-600 btn-icon hover:bg-red-50" title="Borrar"><i className="fa-solid fa-trash"></i></button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            
                            <div className="p-4 bg-slate-50 border-t border-slate-200">
                                <button onClick={() => setCards([...cards, { internalId: generateUniqueId(), front: '', back: '', image: null }])} className="w-full py-4 border-2 border-dashed border-slate-300 rounded-2xl text-slate-400 font-bold hover:border-indigo-500 hover:text-indigo-600 hover:bg-white transition-all flex items-center justify-center gap-2"><i className="fa-solid fa-plus"></i> A√±adir Fila</button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<DashboardCreador />);
    </script>
</body>
</html>
